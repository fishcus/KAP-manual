## 管理数据访问权限

Kyligence Enterprise 提供了丰富的企业级安全控制能力。从 Kyligence Enterprise 3.3.2 开始，每一个用户动作都必需同时具备**操作权限**和**数据访问权限**，然后才能执行。

- 操作权限：定义在项目级别，指定每个用户可以在项目中执行哪些操作。权限由低到高分别为：

  - QUERY：查询权限，允许执行查询。
  - OPERATION：运维权限，允许执行 Cube 的构建、刷新、Segment 管理等，且包含 QUERY 权限。
  - MANAGEMENT：管理权限，允许创建或编辑模型和 Cube，且包含 OPERATION 权限。
  - ADMIN：项目级管理员，允许管理源表，且可以执行项目中的所有操作。

  更多请看[项目级别访问权限](project_acl.cn.md)。

- 数据访问权限：定义在数据上，指定用户可以访问哪些表，以及表中的哪些列和哪些行。
  - 表级权限：指定用户是否可以访问某张表，详见[表级访问权限](table_acl.cn.md)。
  - 列级权限：指定用户是否可以访问表中的某些列，详见[列级访问权限](column_acl.cn.md)。
  - 行级权限：指定用户是否可以访问表中的某些行，详见[行级访问权限](row_acl.cn.md)。



### 一些权限检查的例子

要执行一个动作，用户必需同时具备操作权限和数据访问权限，二者缺一不可。下面是一些例子。

- 要管理数据源，用户首先要有 ADMIN 操作权限；其次，用户只能看到和操作他/她有权限访问的表。（行列级权限并不影响源表管理。）
- 要修改一个模型，用户首先要有 MANAGEMENT 操作权限；其次，用户必需有访问模型中所有的表和列的权限。（行级权限并不影响对模型的操作。）假如用户不具有某些表或列的访问权限，他/她仍然可以在模型列表中看到模型，但不能打开或编辑它。
- 修改 Cube 的检查方式与模型类似。
- 查询主要与数据访问权限有关，因为项目中的所有用户都至少有 QUERY 操作权限。首先，用户必需有访问查询中所有的表和列的权限，否则系统将提示权限不足，无法执行查询。其次，系统只会返回用户有权限访问的行。如果为多个用户设置了不同的行级权限，他们执行同一条查询将有可能返回不同的结果。



### 其他

- Kyligence Enterprise 还支持将数据访问权限委托给第三方权限系统。通过这种模式，您可以用一个已有系统（比如 Hive）中的权限设置来控制 Kyligence Enterprise 中的数据访问，从而避免重复的权限设置工作。详见[与第三方权限系统集成](../integrate_with_3rd_acl.cn.md)。

- 系统管理员默认不受数据访问控制，拥有可以访问所有数据的权限。如果您希望系统管理员也接受数据访问权限约束，请在 `conf/kylin.properties` 中如下配置：

  ```properties
  kylin.security.allow-admin-read-all=false
  ```

- 对于破损的模型（Broken Model），由于其中的表和列信息可能已经破损，只有系统管理员和模型的创建者拥有编辑和查看详情的权限。破损的 Cube 也是类似。

- 对可计算列的列权限检查并不会考虑它引用了哪些列。

- 系统暂时不支持模型和 Cube 级别的操作权限控制。
